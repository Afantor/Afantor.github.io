

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quick reference for the nRF52832 &mdash; MicroPython 1.10 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../static/favicon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../static/customstyle.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="General information about the nRF52832 port" href="general.html" />
    <link rel="prev" title="6. Reset and boot modes" href="../wipy/tutorial/reset.html" /> 

  
  <script src="../static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> MicroPython
          

          
          </a>

          
            
            
              <div class="version">
                1.10
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../library/index.html">MicroPython libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">The MicroPython language</a></li>
<li class="toctree-l1"><a class="reference internal" href="../genrst/index.html">MicroPython differences from CPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../develop/index.html">Developing and building MicroPython</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">MicroPython license information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pyboard/quickref.html">Quick reference for the pyboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../esp8266/quickref.html">Quick reference for the ESP8266</a></li>
<li class="toctree-l1"><a class="reference internal" href="../esp32/quickref.html">Quick reference for the ESP32</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wipy/quickref.html">Quick reference for the WiPy</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick reference for the nRF52832</a><ul>
<li class="toctree-l2"><a class="reference internal" href="general.html">General information about the nRF52832 port</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/intro.html">Getting started with MicroPython on the nRF52832</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installing-micropython">Installing MicroPython</a></li>
<li class="toctree-l2"><a class="reference internal" href="#general-board-control">General board control</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-machine">Machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="#delay-and-timing">Delay and timing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#timers">Timers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pins-and-gpio">Pins and GPIO</a></li>
<li class="toctree-l2"><a class="reference internal" href="#leds-on-board-leds">LEDs (on board leds)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#button-on-board-buttons">BUTTON (on board buttons)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pwm-pulse-width-modulation">PWM (pulse width modulation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adc-analog-to-digital-conversion">ADC (analog to digital conversion)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#software-spi-bus">Software SPI bus</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hardware-spi-bus">Hardware SPI bus</a></li>
<li class="toctree-l2"><a class="reference internal" href="#i2c-bus">I2C bus</a></li>
<li class="toctree-l2"><a class="reference internal" href="#real-time-clock-counter-rtcounter">Real time clock Counter (RTCounter)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deep-sleep-mode">Deep-sleep mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="#temp">Temp</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-machine.UART">UART</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-music">Music</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ble">ble</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ubluepy.html">ubluepy libraries for nRF52832</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MicroPython</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Quick reference for the nRF52832</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../sources/nrf52/quickref.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="quick-reference-for-the-nrf52832">
<span id="nrf52832-quickref"></span><h1>Quick reference for the nRF52832<a class="headerlink" href="#quick-reference-for-the-nrf52832" title="Permalink to this headline">¶</a></h1>
<a class="reference internal image-reference" href="../images/nRF52.JPG"><img alt="nRF52832-Bluefruit52 board" src="../images/nRF52.JPG" style="width: 640px;" /></a>
<p>The Afantor nRF52832 Bluefruit52 Development Board (image attribution: Afantor).</p>
<p>Below is a quick reference for nRF52832-based boards.  If it is your first time
working with this board it may be useful to get an overview of the microcontroller:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="general.html">General information about the nRF52832 port</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial/intro.html">Getting started with MicroPython on the nRF52832</a></li>
</ul>
</div>
<div class="section" id="installing-micropython">
<h2>Installing MicroPython<a class="headerlink" href="#installing-micropython" title="Permalink to this headline">¶</a></h2>
<p>See the corresponding section of tutorial: <a class="reference internal" href="tutorial/intro.html#nrf52-intro"><span class="std std-ref">Getting started with MicroPython on the nRF52832</span></a>. It also includes
a troubleshooting subsection.</p>
</div>
<div class="section" id="general-board-control">
<h2>General board control<a class="headerlink" href="#general-board-control" title="Permalink to this headline">¶</a></h2>
<p>The MicroPython REPL is on UART1 (GPIO0.06=TX, GPIO0.08=RX) at baudrate 115200.
Tab-completion is useful to find out what methods an object has.
Paste mode (ctrl-E) is useful to paste a large slab of Python code into
the REPL.</p>
</div>
<div class="section" id="module-machine">
<span id="machine"></span><h2>Machine<a class="headerlink" href="#module-machine" title="Permalink to this headline">¶</a></h2>
<p>The machine module contains specific functions related to the nRF52832
hardware. Most functions in this module allow to achieve direct and
unrestricted access to and control of hardware blocks on a system (like CPU,
timers, buses, etc.). Used incorrectly, this can lead to malfunction, lockups,
crashes of your board, and in extreme cases, hardware damage.</p>
<p>Functions</p>
<dl class="method">
<dt id="machine.machine.reset">
<code class="descclassname">machine.</code><code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.machine.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the device in a manner similar to pushing the external RESET button.</p>
</dd></dl>

<dl class="method">
<dt id="machine.machine.disable_irq">
<code class="descclassname">machine.</code><code class="descname">disable_irq</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.machine.disable_irq" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable interrupt requests. Returns the previous IRQ state which should be
considered an opaque value. This return value should be passed to the
<a class="reference internal" href="../library/machine.html#machine.enable_irq" title="machine.enable_irq"><code class="xref py py-func docutils literal notranslate"><span class="pre">machine.enable_irq()</span></code></a> function to restore interrupts to their
original state, before <a class="reference internal" href="../library/machine.html#machine.disable_irq" title="machine.disable_irq"><code class="xref py py-func docutils literal notranslate"><span class="pre">machine.disable_irq()</span></code></a> was called.</p>
</dd></dl>

<dl class="method">
<dt id="machine.machine.enable_irq">
<code class="descclassname">machine.</code><code class="descname">enable_irq</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.machine.enable_irq" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-enable interrupt requests. The <em>state</em> parameter should be the value
that was returned from the most recent call to the
<a class="reference internal" href="../library/machine.html#machine.disable_irq" title="machine.disable_irq"><code class="xref py py-func docutils literal notranslate"><span class="pre">machine.disable_irq()</span></code></a> function.</p>
</dd></dl>

<dl class="method">
<dt id="machine.machine.deepsleep">
<code class="descclassname">machine.</code><code class="descname">deepsleep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.machine.deepsleep" title="Permalink to this definition">¶</a></dt>
<dd><p>in to deepsleep mode.</p>
</dd></dl>

<dl class="method">
<dt id="machine.machine.info">
<code class="descclassname">machine.</code><code class="descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.machine.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return machine some information.</p>
</dd></dl>

<dl class="method">
<dt id="machine.machine.lightsleep">
<code class="descclassname">machine.</code><code class="descname">lightsleep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.machine.lightsleep" title="Permalink to this definition">¶</a></dt>
<dd><p>in to lightsleep mode.</p>
</dd></dl>

<dl class="method">
<dt id="machine.machine.reset_cause">
<code class="descclassname">machine.</code><code class="descname">reset_cause</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.machine.reset_cause" title="Permalink to this definition">¶</a></dt>
<dd><p>Return machine reset cause countor.</p>
</dd></dl>

<dl class="method">
<dt id="machine.machine.sleep">
<code class="descclassname">machine.</code><code class="descname">sleep</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.machine.sleep" title="Permalink to this definition">¶</a></dt>
<dd><p>in to lightsleep mode.</p>
</dd></dl>

<dl class="method">
<dt id="machine.machine.soft_reset">
<code class="descclassname">machine.</code><code class="descname">soft_reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.machine.soft_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the device in a manner similar to pushing the external RESET button.</p>
</dd></dl>

<p>The <a class="reference internal" href="#module-machine" title="machine"><code class="xref py py-mod docutils literal notranslate"><span class="pre">machine</span></code></a> module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">machine</span>

<span class="n">machine</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>          <span class="c1"># Return machine some information</span>
<span class="n">machine</span><span class="o">.</span><span class="n">enable_irq</span><span class="p">()</span>    <span class="c1"># Re-enable interrupt requests.</span>
<span class="n">machine</span><span class="o">.</span><span class="n">disable_irq</span><span class="p">()</span>   <span class="c1"># disable interrupt requests.</span>
<span class="n">machine</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>         <span class="c1"># Reset machine system</span>
<span class="n">machine</span><span class="o">.</span><span class="n">soft_reset</span><span class="p">()</span>    <span class="c1"># soft_reset machine system</span>
</pre></div>
</div>
<p>Note that the temperature sensor in the nRF52832 will typically read higher than
ambient due to the IC getting warm while it runs.  This effect can be minimised
by reading the temperature sensor immediately after waking up from sleep.</p>
</div>
<div class="section" id="delay-and-timing">
<h2>Delay and timing<a class="headerlink" href="#delay-and-timing" title="Permalink to this headline">¶</a></h2>
<p>Use the <a class="reference internal" href="../library/utime.html#module-utime" title="utime: time related functions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">time</span></code></a> module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>      <span class="c1"># sleep for 500 milliseconds</span>
<span class="n">time</span><span class="o">.</span><span class="n">sleep_us</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>       <span class="c1"># sleep for 10 microseconds</span>
</pre></div>
</div>
</div>
<div class="section" id="timers">
<h2>Timers<a class="headerlink" href="#timers" title="Permalink to this headline">¶</a></h2>
<p>Hardware timers are supported. Use the <a class="reference internal" href="../library/machine.Timer.html#machine-timer"><span class="std std-ref">machine.Timer</span></a> class
with timer ID of -1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Timer</span>

<span class="n">tim</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tick&quot;</span><span class="p">))</span>
<span class="n">tim</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>         <span class="c1">#enable timer,start count.</span>
<span class="n">tim</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>          <span class="c1">#return counter value(us)</span>
<span class="n">tim</span><span class="o">.</span><span class="n">period</span><span class="p">()</span>        <span class="c1">#return counter value(us)</span>
<span class="n">tim</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>          <span class="c1">#disable timer,stop count.</span>
<span class="n">tim</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>        <span class="c1">#Free resources associated with the timer.</span>
</pre></div>
</div>
<p>Constants</p>
<dl class="data">
<dt id="machine.Timer.ONESHOT">
<code class="descclassname">Timer.</code><code class="descname">ONESHOT</code><a class="headerlink" href="#machine.Timer.ONESHOT" title="Permalink to this definition">¶</a></dt>
<dt id="machine.Timer.PERIODIC">
<code class="descclassname">Timer.</code><code class="descname">PERIODIC</code><a class="headerlink" href="#machine.Timer.PERIODIC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="pins-and-gpio">
<h2>Pins and GPIO<a class="headerlink" href="#pins-and-gpio" title="Permalink to this headline">¶</a></h2>
<p>Use the <a class="reference internal" href="../library/machine.Pin.html#machine-pin"><span class="std std-ref">machine.Pin</span></a> class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Pin</span>

<span class="n">p2</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>    <span class="c1"># create output pin on GPIO0.02</span>
<span class="n">p2</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>                 <span class="c1"># set pin to &quot;on&quot; (high) level</span>
<span class="n">p2</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>                <span class="c1"># set pin to &quot;off&quot; (low) level</span>
<span class="n">p2</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>             <span class="c1"># set pin to on/high</span>

<span class="n">p3</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>     <span class="c1"># create input pin on GPIO0.03</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p3</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>       <span class="c1"># get value, 0 or 1</span>

<span class="n">p4</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">Pin</span><span class="o">.</span><span class="n">PULL_UP</span><span class="p">)</span> <span class="c1"># enable internal pull-up resistor</span>
<span class="n">p5</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># set pin high on creation</span>
</pre></div>
</div>
<p>Constants</p>
<dl class="data">
<dt id="machine.Pin.IN">
<code class="descclassname">Pin.</code><code class="descname">IN</code><a class="headerlink" href="#machine.Pin.IN" title="Permalink to this definition">¶</a></dt>
<dt id="machine.Pin.OUT">
<code class="descclassname">Pin.</code><code class="descname">OUT</code><a class="headerlink" href="#machine.Pin.OUT" title="Permalink to this definition">¶</a></dt>
<dt id="machine.Pin.PULL_UP">
<code class="descclassname">Pin.</code><code class="descname">PULL_UP</code><a class="headerlink" href="#machine.Pin.PULL_UP" title="Permalink to this definition">¶</a></dt>
<dt id="machine.Pin.PULL_DOWN">
<code class="descclassname">Pin.</code><code class="descname">PULL_DOWN</code><a class="headerlink" href="#machine.Pin.PULL_DOWN" title="Permalink to this definition">¶</a></dt>
<dt id="machine.Pin.PULL_DISABLED">
<code class="descclassname">Pin.</code><code class="descname">PULL_DISABLED</code><a class="headerlink" href="#machine.Pin.PULL_DISABLED" title="Permalink to this definition">¶</a></dt>
<dt id="machine.Pin.IRQ_FALLING">
<code class="descclassname">Pin.</code><code class="descname">IRQ_FALLING</code><a class="headerlink" href="#machine.Pin.IRQ_FALLING" title="Permalink to this definition">¶</a></dt>
<dt id="machine.Pin.IRQ_RISING">
<code class="descclassname">Pin.</code><code class="descname">IRQ_RISING</code><a class="headerlink" href="#machine.Pin.IRQ_RISING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Available Pins are from the following ranges (inclusive): 2-20, 23-31.
These correspond to the actual GPIO pin numbers of nRF52832 chip.  Note that many
end-user boards use their own adhoc pin numbering (marked e.g. D0, D1, …).
For mapping between board logical pins and physical chip pins consult your board
documentation.</p>
<p>Notes:</p>
<ul class="simple">
<li>Pins 6 and 8 are REPL UART TX and RX respectively</li>
<li>Pins 7, 16, 23, 24， and 27 are used for connecting the lcd screen driver,
and are not recommended for other uses</li>
<li>Pins 11 and 18 are used for connecting the button, and it have been pull up 10k to 3.3v</li>
<li>Pins 17 and 19 are used for connecting the led.</li>
</ul>
</div>
<div class="section" id="leds-on-board-leds">
<h2>LEDs (on board leds)<a class="headerlink" href="#leds-on-board-leds" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>nRF52832-Bluefruit52 board have two leds, connect to pin 17 and 19. Here are some function:</div></blockquote>
<dl class="docutils">
<dt>Use the <code class="docutils literal notranslate"><span class="pre">board.LED</span></code> class::</dt>
<dd>import board
led1 = board.LED(1)         #LED(1) connect pin17
led2 = board.LED(2)         #LED(2) connect pin19
led1.on()                   #LED(1) show on.
led2.on()                   #LED(2) show on.
led1.off()                  #LED(1) show off.
led2.off()                  #LED(2) show off.
led1.toggle()               #LED(1) toggle show.
led2.toggle()               #LED(2) toggle show.</dd>
</dl>
</div>
<div class="section" id="button-on-board-buttons">
<h2>BUTTON (on board buttons)<a class="headerlink" href="#button-on-board-buttons" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>nRF52832-Bluefruit52 board have two buttons, connect to pin 11 and 18. Here are some function:</div></blockquote>
<dl class="docutils">
<dt>Use the <code class="docutils literal notranslate"><span class="pre">board.BUTTON</span></code> class::</dt>
<dd>import board
btn1 = board.BUTTON(1)      #BUTTON(1) connect pin18
btn2 = board.BUTTON(2)      #BUTTON(2) connect pin11
btn1.isPressed()            #check button is pressed, if pressed return True, else return False
btn1.getPresses()           #get button pin level state. Default HIGH is 1, if button is pressed return 0.</dd>
<dt>example for button control led::</dt>
<dd><p class="first">import board
led1 = board.LED(1)
led2 = board.LED(2)</p>
<p>btn1 = board.BUTTON(1)
btn2 = board.BUTTON(2)</p>
<dl class="last docutils">
<dt>while True:</dt>
<dd><dl class="first last docutils">
<dt>if btn1.isPressed():       #scan button 1</dt>
<dd>led1.toggle()          #LED(1) toggle</dd>
<dt>if btn2.isPressed():       #scan button 2</dt>
<dd>led2.toggle()          #LED(2) toggle</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</div>
<div class="section" id="pwm-pulse-width-modulation">
<h2>PWM (pulse width modulation)<a class="headerlink" href="#pwm-pulse-width-modulation" title="Permalink to this headline">¶</a></h2>
<p>PWM can be enabled on all output-enabled pins. The base frequency can
range from 1Hz to 16MHz but there is a tradeoff; as the base frequency
<em>increases</em> the duty resolution <em>decreases</em>.</p>
<p>PWM id optional is 0,1,2.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">machine.PWM</span></code> class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Pin</span><span class="p">,</span> <span class="n">PWM</span>

<span class="c1"># create PWM object from id, pin, freq and set duty, period.</span>
<span class="c1"># eg. use PWM(0) for P11 pin out, and set frequency is 1000Hz, duty is 90%.</span>
<span class="c1"># if you want to change frequency, you need change &#39;freq&#39; and &#39;period&#39; parameter. freq_out = freq/period.</span>
<span class="n">pwm0</span> <span class="o">=</span> <span class="n">PWM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">pin</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">),</span><span class="n">freq</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">FREQ_16MHZ</span><span class="p">,</span><span class="n">duty</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span><span class="n">period</span><span class="o">=</span><span class="mi">16000</span><span class="p">)</span>
<span class="n">pwm0</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>             <span class="c1"># start pwm out</span>
<span class="n">pwm0</span><span class="o">.</span><span class="n">freq</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>         <span class="c1"># nothing work</span>
<span class="n">pwm0</span><span class="o">.</span><span class="n">duty</span><span class="p">()</span>             <span class="c1"># nothing work</span>
<span class="n">pwm0</span><span class="o">.</span><span class="n">duty</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>          <span class="c1"># nothing work</span>
<span class="n">pwm0</span><span class="o">.</span><span class="n">period</span><span class="p">()</span>           <span class="c1"># nothing work</span>
<span class="n">pwm0</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>           <span class="c1"># turn off PWM on the pin,Free resources associated with the timer.</span>
</pre></div>
</div>
<p>Constants</p>
<dl class="data">
<dt id="machine.PWM.FREQ_16MHZ">
<code class="descclassname">PWM.</code><code class="descname">FREQ_16MHZ</code><a class="headerlink" href="#machine.PWM.FREQ_16MHZ" title="Permalink to this definition">¶</a></dt>
<dt id="machine.PWM.FREQ_8MHZ">
<code class="descclassname">PWM.</code><code class="descname">FREQ_8MHZ</code><a class="headerlink" href="#machine.PWM.FREQ_8MHZ" title="Permalink to this definition">¶</a></dt>
<dt id="machine.PWM.FREQ_4MHZ">
<code class="descclassname">PWM.</code><code class="descname">FREQ_4MHZ</code><a class="headerlink" href="#machine.PWM.FREQ_4MHZ" title="Permalink to this definition">¶</a></dt>
<dt id="machine.PWM.FREQ_2MHZ">
<code class="descclassname">PWM.</code><code class="descname">FREQ_2MHZ</code><a class="headerlink" href="#machine.PWM.FREQ_2MHZ" title="Permalink to this definition">¶</a></dt>
<dt id="machine.PWM.FREQ_1MHZ">
<code class="descclassname">PWM.</code><code class="descname">FREQ_1MHZ</code><a class="headerlink" href="#machine.PWM.FREQ_1MHZ" title="Permalink to this definition">¶</a></dt>
<dt id="machine.PWM.FREQ_500KHZ">
<code class="descclassname">PWM.</code><code class="descname">FREQ_500KHZ</code><a class="headerlink" href="#machine.PWM.FREQ_500KHZ" title="Permalink to this definition">¶</a></dt>
<dt id="machine.PWM.FREQ_250KHZ">
<code class="descclassname">PWM.</code><code class="descname">FREQ_250KHZ</code><a class="headerlink" href="#machine.PWM.FREQ_250KHZ" title="Permalink to this definition">¶</a></dt>
<dt id="machine.PWM.FREQ_125KHZ">
<code class="descclassname">PWM.</code><code class="descname">FREQ_125KHZ</code><a class="headerlink" href="#machine.PWM.FREQ_125KHZ" title="Permalink to this definition">¶</a></dt>
<dt id="machine.PWM.MODE_LOW_HIGH">
<code class="descclassname">PWM.</code><code class="descname">MODE_LOW_HIGH</code><a class="headerlink" href="#machine.PWM.MODE_LOW_HIGH" title="Permalink to this definition">¶</a></dt>
<dt id="machine.PWM.MODE_HIGH_LOW">
<code class="descclassname">PWM.</code><code class="descname">MODE_HIGH_LOW</code><a class="headerlink" href="#machine.PWM.MODE_HIGH_LOW" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p>Available Pins are from the following ranges (inclusive): 2-5, 11-20, 25-31.</p>
</div>
<div class="section" id="adc-analog-to-digital-conversion">
<h2>ADC (analog to digital conversion)<a class="headerlink" href="#adc-analog-to-digital-conversion" title="Permalink to this headline">¶</a></h2>
<p>On the nRF52832 ADC functionality is available 8 channels（0~7）. Note that, when
using the default configuration, input voltages on the ADC pin must be between
0.0v and 3.3v.  Attenuation must be applied in order to increase this usable voltage range.</p>
<p>Notes, Analog Pin:</p>
<ul class="simple">
<li>ADC(1)—&gt;GPIO0.02</li>
<li>ADC(2)—&gt;GPIO0.03</li>
<li>ADC(3)—&gt;GPIO0.04</li>
<li>ADC(4)—&gt;GPIO0.05</li>
<li>ADC(5)—&gt;GPIO0.28</li>
<li>ADC(6)—&gt;GPIO0.29</li>
<li>ADC(7)—&gt;GPIO0.30</li>
</ul>
<p>Use the <a class="reference internal" href="../library/machine.ADC.html#machine-adc"><span class="std std-ref">machine.ADC</span></a> class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">ADC</span>

<span class="n">adc3</span> <span class="o">=</span> <span class="n">ADC</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                <span class="c1"># create ADC object on ADC pin.(ADC(3)---&gt;GPIO0.04)</span>
<span class="n">adc3</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>                 <span class="c1"># read value, 0-255 across voltage range 0.0v - 3.3v</span>

<span class="n">ADC</span><span class="o">.</span><span class="n">battery_level</span><span class="p">()</span>          <span class="c1"># read battery value.</span>
</pre></div>
</div>
</div>
<div class="section" id="software-spi-bus">
<h2>Software SPI bus<a class="headerlink" href="#software-spi-bus" title="Permalink to this headline">¶</a></h2>
<p>There are two SPI drivers. One is implemented in software (bit-banging)
and works on all pins, and is accessed via the <a class="reference internal" href="../library/machine.SPI.html#machine-spi"><span class="std std-ref">machine.SPI</span></a>
class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Pin</span><span class="p">,</span> <span class="n">SPI</span>

<span class="c1"># construct an SPI bus on the given pins</span>
<span class="c1"># polarity is the idle state of SCK</span>
<span class="c1"># phase=0 means sample on the first edge of SCK, phase=1 means the second</span>
<span class="n">spi</span> <span class="o">=</span> <span class="n">SPI</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">baudrate</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">polarity</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sck</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">mosi</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="n">miso</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>

<span class="n">spi</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">baudrate</span><span class="o">=</span><span class="mi">200000</span><span class="p">)</span> <span class="c1"># set the baudrate</span>

<span class="n">spi</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>            <span class="c1"># read 10 bytes on MISO</span>
<span class="n">spi</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">)</span>      <span class="c1"># read 10 bytes while outputing 0xff on MOSI</span>

<span class="n">buf</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>     <span class="c1"># create a buffer</span>
<span class="n">spi</span><span class="o">.</span><span class="n">readinto</span><span class="p">(</span><span class="n">buf</span><span class="p">)</span>       <span class="c1"># read into the given buffer (reads 50 bytes in this case)</span>
<span class="n">spi</span><span class="o">.</span><span class="n">readinto</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="mh">0xff</span><span class="p">)</span> <span class="c1"># read into the given buffer and output 0xff on MOSI</span>

<span class="n">spi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;12345&#39;</span><span class="p">)</span>     <span class="c1"># write 5 bytes on MOSI</span>

<span class="n">buf</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>      <span class="c1"># create a buffer</span>
<span class="n">spi</span><span class="o">.</span><span class="n">write_readinto</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;1234&#39;</span><span class="p">,</span> <span class="n">buf</span><span class="p">)</span> <span class="c1"># write to MOSI and read from MISO into the buffer</span>
<span class="n">spi</span><span class="o">.</span><span class="n">write_readinto</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">buf</span><span class="p">)</span> <span class="c1"># write buf to MOSI and read MISO back into buf</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Currently <em>all</em> of <code class="docutils literal notranslate"><span class="pre">sck</span></code>, <code class="docutils literal notranslate"><span class="pre">mosi</span></code> and <code class="docutils literal notranslate"><span class="pre">miso</span></code> <em>must</em> be specified when
initialising Software SPI.</p>
</div>
<p>Functions</p>
<dl class="method">
<dt id="machine.init">
<code class="descclassname">machine.</code><code class="descname">init</code><span class="sig-paren">(</span><em>baudrate=1000000</em>, <em>bits=8</em>, <em>mode=0</em>, <em>sclk=pin12</em>, <em>mosi=pin13</em>, <em>miso=pin14</em><span class="sig-paren">)</span><a class="headerlink" href="#machine.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize SPI communication with the specified parameters on the
specified <code class="docutils literal notranslate"><span class="pre">pins</span></code>. Note that for correct communication, the parameters
have to be the same on both communicating devices.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">baudrate</span></code> defines the speed of communication.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bits</span></code> defines the size of bytes being transmitted. Currently only
<code class="docutils literal notranslate"><span class="pre">bits=8</span></code> is supported. However, this may change in the future.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mode</span></code> determines the combination of clock polarity and phase
according to the following convention, with polarity as the high order bit
and phase as the low order bit:</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="41%" />
<col width="34%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">SPI Mode</th>
<th class="head">Polarity (CPOL)</th>
<th class="head">Phase (CPHA)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="row-even"><td>2</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Polarity (aka CPOL) 0 means that the clock is at logic value 0 when idle
and goes high (logic value 1) when active; polarity 1 means the clock is
at logic value 1 when idle and goes low (logic value 0) when active. Phase
(aka CPHA) 0 means that data is sampled on the leading edge of the clock,
and 1 means on the trailing edge
(viz. <a class="reference external" href="https://en.wikipedia.org/wiki/Signal_edge">https://en.wikipedia.org/wiki/Signal_edge</a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sclk</span></code>, <code class="docutils literal notranslate"><span class="pre">mosi</span></code> and <code class="docutils literal notranslate"><span class="pre">miso</span></code> arguments specify the pins to use for
each type of signal.</p>
</dd></dl>

<dl class="method">
<dt id="machine.spi.read">
<code class="descclassname">spi.</code><code class="descname">read</code><span class="sig-paren">(</span><em>nbytes</em><span class="sig-paren">)</span><a class="headerlink" href="#machine.spi.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read at most <code class="docutils literal notranslate"><span class="pre">nbytes</span></code>. Returns what was read.</p>
</dd></dl>

<dl class="method">
<dt id="machine.spi.write">
<code class="descclassname">spi.</code><code class="descname">write</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#machine.spi.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the <code class="docutils literal notranslate"><span class="pre">buffer</span></code> of bytes to the bus.</p>
</dd></dl>

<dl class="method">
<dt id="machine.spi.write_readinto">
<code class="descclassname">spi.</code><code class="descname">write_readinto</code><span class="sig-paren">(</span><em>out</em>, <em>in</em><span class="sig-paren">)</span><a class="headerlink" href="#machine.spi.write_readinto" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the <code class="docutils literal notranslate"><span class="pre">out</span></code> buffer to the bus and read any response into the <code class="docutils literal notranslate"><span class="pre">in</span></code>
buffer. The length of the buffers should be the same. The buffers can be
the same object.</p>
</dd></dl>

</div>
<div class="section" id="hardware-spi-bus">
<h2>Hardware SPI bus<a class="headerlink" href="#hardware-spi-bus" title="Permalink to this headline">¶</a></h2>
<p>There is one hardware SPI channels that allow faster transmission rates,
but are only supported on a subset of pins.</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"></th>
<th class="head">SPI (id=0)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>sck</td>
<td>12</td>
</tr>
<tr class="row-odd"><td>mosi</td>
<td>13</td>
</tr>
<tr class="row-even"><td>miso</td>
<td>14</td>
</tr>
</tbody>
</table>
<p>Hardware SPI has the same methods as Software SPI above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Pin</span><span class="p">,</span> <span class="n">SPI</span>

<span class="n">hspi</span> <span class="o">=</span> <span class="n">SPI</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">baudrate</span><span class="o">=</span><span class="mi">10000000</span><span class="p">,</span> <span class="n">polarity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">phase</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bits</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">firstbit</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sck</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="n">mosi</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span> <span class="n">miso</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="i2c-bus">
<h2>I2C bus<a class="headerlink" href="#i2c-bus" title="Permalink to this headline">¶</a></h2>
<p>The I2C driver is implemented in software and works on all pins,
and is accessed via the <a class="reference internal" href="../library/machine.I2C.html#machine-i2c"><span class="std std-ref">machine.I2C</span></a> class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Pin</span><span class="p">,</span> <span class="n">I2C</span>

<span class="c1"># construct an I2C bus</span>
<span class="n">i2c</span> <span class="o">=</span> <span class="n">I2C</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">scl</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">26</span><span class="p">),</span> <span class="n">sda</span><span class="o">=</span><span class="n">Pin</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>

<span class="n">i2c</span><span class="o">.</span><span class="n">scan</span><span class="p">()</span>

<span class="n">i2c</span><span class="o">.</span><span class="n">readfrom</span><span class="p">(</span><span class="mh">0x3a</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>   <span class="c1"># read 4 bytes from slave device with address 0x3a</span>
<span class="n">i2c</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="mh">0x3a</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">)</span> <span class="c1"># write &#39;12&#39; to slave device with address 0x3a</span>

<span class="n">buf</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>     <span class="c1"># create a buffer with 10 bytes</span>
<span class="n">i2c</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="mh">0x3a</span><span class="p">,</span> <span class="n">buf</span><span class="p">)</span>  <span class="c1"># write the given buffer to the slave</span>
</pre></div>
</div>
<p>Connecting</p>
<p>You should connect the device’s <code class="docutils literal notranslate"><span class="pre">SCL</span></code> pin to Bluefruit52 pin 26, and the
device’s <code class="docutils literal notranslate"><span class="pre">SDA</span></code> pin to Bluefruit52 pin 25. You also must connect the device’s
ground to the Bluefruit52 ground (pin <code class="docutils literal notranslate"><span class="pre">GND</span></code>). You may need to power the device
using an external power supply or the Bluefruit52.</p>
<p>There are internal pull-up resistors on the I²C lines of the board, but with
particularly long wires or large number of devices you may need to add
additional pull-up resistors, to ensure noise-free communication.</p>
</div>
<div class="section" id="real-time-clock-counter-rtcounter">
<h2>Real time clock Counter (RTCounter)<a class="headerlink" href="#real-time-clock-counter-rtcounter" title="Permalink to this headline">¶</a></h2>
<p>See <span class="xref std std-ref">machine.RTCounter</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">RTCounter</span>

<span class="n">rtcount</span> <span class="o">=</span> <span class="n">RTCounter</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tick&quot;</span><span class="p">))</span>
<span class="c1"># Start the RTCounter. Timeout occurs after number of periods</span>
<span class="c1"># in the configured frequency has been reached.</span>
<span class="n">rtcount</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="c1"># Return the current counter value. Wraps around after about 24 days</span>
<span class="c1"># with the current prescaler (2^24 / 8 = 2097152 seconds).</span>
<span class="n">rtcount</span><span class="o">.</span><span class="n">counter</span><span class="p">()</span>
<span class="n">rtcount</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>          <span class="c1"># Stop the RTCounter.</span>
<span class="n">rtcount</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>        <span class="c1"># Free resources associated with this RTC.</span>
</pre></div>
</div>
<p>Constants</p>
<dl class="data">
<dt id="machine.RTCounter.ONESHOT">
<code class="descclassname">RTCounter.</code><code class="descname">ONESHOT</code><a class="headerlink" href="#machine.RTCounter.ONESHOT" title="Permalink to this definition">¶</a></dt>
<dt id="machine.RTCounter.PERIODIC">
<code class="descclassname">RTCounter.</code><code class="descname">PERIODIC</code><a class="headerlink" href="#machine.RTCounter.PERIODIC" title="Permalink to this definition">¶</a></dt>
<dt id="machine.RTCounter.FREQUENCY">
<code class="descclassname">RTCounter.</code><code class="descname">FREQUENCY</code><a class="headerlink" href="#machine.RTCounter.FREQUENCY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="deep-sleep-mode">
<h2>Deep-sleep mode<a class="headerlink" href="#deep-sleep-mode" title="Permalink to this headline">¶</a></h2>
<p>The following code can be used to sleep, wake and check the reset cause:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">machine</span>

<span class="c1"># check if the device woke from a deep sleep</span>
<span class="k">if</span> <span class="n">machine</span><span class="o">.</span><span class="n">reset_cause</span><span class="p">()</span> <span class="o">==</span> <span class="n">machine</span><span class="o">.</span><span class="n">DEEPSLEEP_RESET</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;woke from a deep sleep&#39;</span><span class="p">)</span>

<span class="c1"># put the device to sleep</span>
<span class="n">machine</span><span class="o">.</span><span class="n">deepsleep</span><span class="p">()</span>
</pre></div>
</div>
<p>Notes:</p>
<ul class="simple">
<li>Calling <code class="docutils literal notranslate"><span class="pre">deepsleep()</span></code> without an argument will put the device to sleep
indefinitely</li>
<li>A software reset does not change the reset cause</li>
</ul>
</div>
<div class="section" id="temp">
<h2>Temp<a class="headerlink" href="#temp" title="Permalink to this headline">¶</a></h2>
<p>The following code can be used to read temperature from on-soc:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">machine</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">machine</span><span class="o">.</span><span class="n">Temp</span><span class="p">()</span>

<span class="n">temp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>         <span class="c1"># Get temperature.</span>
</pre></div>
</div>
</div>
<div class="section" id="module-machine.UART">
<span id="uart"></span><h2>UART<a class="headerlink" href="#module-machine.UART" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">UART</span></code> module lets you talk to a device connected to your board using
a serial interface.</p>
<p>Functions</p>
<dl class="method">
<dt id="machine.UART.UART">
<code class="descclassname">machine.UART.</code><code class="descname">UART</code><span class="sig-paren">(</span><em>id=0</em>, <em>baudrate=115200</em><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.UART" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize serial communication with the specified parameters on the
specified <code class="docutils literal notranslate"><span class="pre">tx</span></code> and <code class="docutils literal notranslate"><span class="pre">rx</span></code> pins. Note that for correct communication, the parameters
have to be the same on both communicating devices.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Initializing the UART on external pins will cause the Python console on
USB to become unaccessible, as it uses the same hardware. To bring the
console back you must reinitialize the UART without passing anything for
<code class="docutils literal notranslate"><span class="pre">tx</span></code> or <code class="docutils literal notranslate"><span class="pre">rx</span></code> (or passing <code class="docutils literal notranslate"><span class="pre">None</span></code> to these arguments).  This means
that calling <code class="docutils literal notranslate"><span class="pre">uart.init(115200)</span></code> is enough to restore the Python console.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">baudrate</span></code> defines the speed of communication. Common baud
rates include:</p>
<blockquote>
<div><ul class="simple">
<li>9600</li>
<li>14400</li>
<li>19200</li>
<li>28800</li>
<li>38400</li>
<li>57600</li>
<li>115200</li>
</ul>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">bits</span></code> defines the size of bytes being transmitted, and the board
only supports 8. The <code class="docutils literal notranslate"><span class="pre">parity</span></code> parameter defines how parity is checked,
and it can be <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">microbit.uart.ODD</span></code> or <code class="docutils literal notranslate"><span class="pre">microbit.uart.EVEN</span></code>.
The <code class="docutils literal notranslate"><span class="pre">stop</span></code> parameter tells the number of stop bits, and has to be 1 for
this board.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">tx</span></code> and <code class="docutils literal notranslate"><span class="pre">rx</span></code> are not specified then the internal USB-UART TX/RX pins
are used which connect to the USB serial converter on the micro:bit, thus
connecting the UART to your PC.  You can specify any other pins you want by
passing the desired pin objects to the <code class="docutils literal notranslate"><span class="pre">tx</span></code> and <code class="docutils literal notranslate"><span class="pre">rx</span></code> parameters.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When connecting the device, make sure you “cross” the wires – the TX
pin on your board needs to be connected with the RX pin on the device,
and the RX pin – with the TX pin on the device. Also make sure the
ground pins of both devices are connected.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="machine.UART.uart.read">
<code class="descclassname">uart.</code><code class="descname">read</code><span class="sig-paren">(</span><span class="optional">[</span><em>nbytes</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.uart.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read bytes.  If <code class="docutils literal notranslate"><span class="pre">nbytes</span></code> is specified then read at most that many
bytes, otherwise read as many bytes as possible.</p>
<p>Return value: a bytes object or <code class="docutils literal notranslate"><span class="pre">None</span></code> on timeout.</p>
<p>A bytes object contains a sequence of bytes. Because
<a class="reference external" href="https://en.wikipedia.org/wiki/ASCII">ASCII</a> characters can fit in
single bytes this type of object is often used to represent simple text
and offers methods to manipulate it as such, e.g. you can display the text
using the <code class="docutils literal notranslate"><span class="pre">print()</span></code> function.</p>
<p>You can also convert this object into a string object, and if there are
non-ASCII characters present the encoding can be specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">msg_bytes</span> <span class="o">=</span> <span class="n">uart</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">msg_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The timeout for all UART reads depends on the baudrate and is otherwise
not changeable via Python. The timeout, in milliseconds, is given by:
<code class="docutils literal notranslate"><span class="pre">microbit_uart_timeout_char</span> <span class="pre">=</span> <span class="pre">13000</span> <span class="pre">/</span> <span class="pre">baudrate</span> <span class="pre">+</span> <span class="pre">1</span></code></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The internal UART RX buffer is 64 bytes, so make sure data is read
before the buffer is full or some of the data might be lost.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Receiving <code class="docutils literal notranslate"><span class="pre">0x03</span></code> will stop your program by raising a Keyboard
Interrupt. You can enable or disable this using
<a class="reference internal" href="../library/micropython.html#micropython.kbd_intr" title="micropython.kbd_intr"><code class="xref py py-func docutils literal notranslate"><span class="pre">micropython.kbd_intr()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="machine.UART.uart.readinto">
<code class="descclassname">uart.</code><code class="descname">readinto</code><span class="sig-paren">(</span><em>buf</em><span class="optional">[</span>, <em>nbytes</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.uart.readinto" title="Permalink to this definition">¶</a></dt>
<dd><p>Read bytes into the <code class="docutils literal notranslate"><span class="pre">buf</span></code>.  If <code class="docutils literal notranslate"><span class="pre">nbytes</span></code> is specified then read at most
that many bytes.  Otherwise, read at most <code class="docutils literal notranslate"><span class="pre">len(buf)</span></code> bytes.</p>
<p>Return value: number of bytes read and stored into <code class="docutils literal notranslate"><span class="pre">buf</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code> on
timeout.</p>
</dd></dl>

<dl class="method">
<dt id="machine.UART.uart.readline">
<code class="descclassname">uart.</code><code class="descname">readline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.uart.readline" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a line, ending in a newline character.</p>
<p>Return value: the line read or <code class="docutils literal notranslate"><span class="pre">None</span></code> on timeout. The newline character is
included in the returned bytes.</p>
</dd></dl>

<dl class="method">
<dt id="machine.UART.uart.readchar">
<code class="descclassname">uart.</code><code class="descname">readchar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.uart.readchar" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a char.</p>
<p>Return value: the char read or <code class="docutils literal notranslate"><span class="pre">None</span></code> on timeout.</p>
</dd></dl>

<dl class="method">
<dt id="machine.UART.uart.writechar">
<code class="descclassname">uart.</code><code class="descname">writechar</code><span class="sig-paren">(</span><em>buf</em><span class="sig-paren">)</span><a class="headerlink" href="#machine.UART.uart.writechar" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a ASCII char number to the bus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">uart</span><span class="o">.</span><span class="n">writechar</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>  <span class="c1">#write &#39;!&#39;</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-music">
<span id="music"></span><h2>Music<a class="headerlink" href="#module-music" title="Permalink to this headline">¶</a></h2>
<p>This is the <code class="docutils literal notranslate"><span class="pre">music</span></code> module. You can use it to play simple tunes, provided
that you connect a speaker to your board. By default the <code class="docutils literal notranslate"><span class="pre">music</span></code> module
expects the speaker to be connected via pin 30:</p>
<p>This arrangement can be overridden (as discussed below).</p>
<p>To access this module you need to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">music</span>
</pre></div>
</div>
<p>We assume you have done this for the examples below.</p>
<p>Musical Notation</p>
<p>An individual note is specified thus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NOTE</span><span class="p">[</span><span class="n">octave</span><span class="p">][:</span><span class="n">duration</span><span class="p">]</span>
</pre></div>
</div>
<p>For example, <code class="docutils literal notranslate"><span class="pre">A1:4</span></code> refers to the note “A” in octave 1 that lasts for four
ticks (a tick is an arbitrary length of time defined by a tempo setting
function - see below). If the note name <code class="docutils literal notranslate"><span class="pre">R</span></code> is used then it is treated as a
rest (silence).</p>
<p>Accidentals (flats and sharps) are denoted by the <code class="docutils literal notranslate"><span class="pre">b</span></code> (flat - a lower case b)
and <code class="docutils literal notranslate"><span class="pre">#</span></code> (sharp - a hash symbol). For example, <code class="docutils literal notranslate"><span class="pre">Ab</span></code> is A-flat and <code class="docutils literal notranslate"><span class="pre">C#</span></code> is
C-sharp.</p>
<p><strong>Note names are case-insensitive.</strong></p>
<p>The <code class="docutils literal notranslate"><span class="pre">octave</span></code> and <code class="docutils literal notranslate"><span class="pre">duration</span></code> parameters are states that carry over to
subsequent notes until re-specified. The default states are <code class="docutils literal notranslate"><span class="pre">octave</span> <span class="pre">=</span> <span class="pre">4</span></code>
(containing middle C) and <code class="docutils literal notranslate"><span class="pre">duration</span> <span class="pre">=</span> <span class="pre">4</span></code> (a crotchet, given the default tempo
settings - see below).</p>
<p>For example, if 4 ticks is a crotchet, the following list is crotchet, quaver,
quaver, crotchet based arpeggio:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;c1:4&#39;</span><span class="p">,</span> <span class="s1">&#39;e:2&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;c2:4&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The opening of Beethoven’s 5th Symphony would be encoded thus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;r4:2&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;eb:8&#39;</span><span class="p">,</span> <span class="s1">&#39;r:2&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;d:8&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The definition and scope of an octave conforms to the table listed <a class="reference external" href="https://en.wikipedia.org/wiki/Scientific_pitch_notation#Table_of_note_frequencies">on this
page about scientific pitch notation</a>.  For example, middle “C” is <code class="docutils literal notranslate"><span class="pre">'c4'</span></code> and
concert “A” (440) is <code class="docutils literal notranslate"><span class="pre">'a4'</span></code>. Octaves start on the note “C”.</p>
<p>Functions</p>
<dl class="function">
<dt id="music.set_tempo">
<code class="descclassname">music.</code><code class="descname">set_tempo</code><span class="sig-paren">(</span><em>ticks=4</em>, <em>bpm=120</em><span class="sig-paren">)</span><a class="headerlink" href="#music.set_tempo" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the approximate tempo for playback.</p>
<p>A number of ticks (expressed as an integer) constitute a beat. Each beat is to be played at a certain frequency per minute (expressed as the more familiar BPM - beats per minute - also as an integer).</p>
<p>Suggested default values allow the following useful behaviour:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">music.set_tempo()</span></code> - reset the tempo to default of ticks = 4, bpm = 120</li>
<li><code class="docutils literal notranslate"><span class="pre">music.set_tempo(ticks=8)</span></code> - change the “definition” of a beat</li>
<li><code class="docutils literal notranslate"><span class="pre">music.set_tempo(bpm=180)</span></code> - just change the tempo</li>
</ul>
<p>To work out the length of a tick in milliseconds is very simple arithmetic: <code class="docutils literal notranslate"><span class="pre">60000/bpm/ticks_per_beat</span></code> . For the default values that’s <code class="docutils literal notranslate"><span class="pre">60000/120/4</span> <span class="pre">=</span> <span class="pre">125</span> <span class="pre">milliseconds</span></code> or <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">beat</span> <span class="pre">=</span> <span class="pre">500</span> <span class="pre">milliseconds</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="music.get_tempo">
<code class="descclassname">music.</code><code class="descname">get_tempo</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#music.get_tempo" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the current tempo as a tuple of integers: <code class="docutils literal notranslate"><span class="pre">(ticks,</span> <span class="pre">bpm)</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="music.play">
<code class="descclassname">music.</code><code class="descname">play</code><span class="sig-paren">(</span><em>music</em>, <em>pin=microbit.pin0</em>, <em>wait=True</em>, <em>loop=False</em><span class="sig-paren">)</span><a class="headerlink" href="#music.play" title="Permalink to this definition">¶</a></dt>
<dd><p>Plays <code class="docutils literal notranslate"><span class="pre">music</span></code> containing the musical DSL defined above.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">music</span></code> is a string it is expected to be a single note such as,
<code class="docutils literal notranslate"><span class="pre">'c1:4'</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">music</span></code> is specified as a list of notes (as defined in the section on
the musical DSL, above) then they are played one after the other to perform
a melody.</p>
<p>In both cases, the <code class="docutils literal notranslate"><span class="pre">duration</span></code> and <code class="docutils literal notranslate"><span class="pre">octave</span></code> values are reset to
their defaults before the music (whatever it may be) is played.</p>
<p>An optional argument to specify the output pin can be used to override the
default of <code class="docutils literal notranslate"><span class="pre">microbit.pin0</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">wait</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, this function is blocking.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">loop</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the tune repeats until <code class="docutils literal notranslate"><span class="pre">stop</span></code> is called
(see below) or the blocking call is interrupted.</p>
</dd></dl>

<dl class="function">
<dt id="music.pitch">
<code class="descclassname">music.</code><code class="descname">pitch</code><span class="sig-paren">(</span><em>frequency</em>, <em>duration=-1</em>, <em>pin=microbit.pin0</em>, <em>wait=True</em><span class="sig-paren">)</span><a class="headerlink" href="#music.pitch" title="Permalink to this definition">¶</a></dt>
<dd><p>Plays a pitch at the integer frequency given for the specified number of
milliseconds. For example, if the frequency is set to 440 and the length to
1000 then we hear a standard concert A for one second.</p>
<p>Note that you can only play one pitch on one pin at any one time.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">wait</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, this function is blocking.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">duration</span></code> is negative the pitch is played continuously until either the
blocking call is interrupted or, in the case of a background call, a new
frequency is set or <code class="docutils literal notranslate"><span class="pre">stop</span></code> is called (see below).</p>
</dd></dl>

<dl class="function">
<dt id="music.stop">
<code class="descclassname">music.</code><code class="descname">stop</code><span class="sig-paren">(</span><em>pin=microbit.pin0</em><span class="sig-paren">)</span><a class="headerlink" href="#music.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Stops all music playback on a given pin, eg. <code class="docutils literal notranslate"><span class="pre">music.stop(pin1)</span></code>.
If no pin is given, eg. <code class="docutils literal notranslate"><span class="pre">music.stop()</span></code> pin0 is assumed.</p>
</dd></dl>

<dl class="function">
<dt id="music.reset">
<code class="descclassname">music.</code><code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#music.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the state of the following attributes in the following way:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ticks</span> <span class="pre">=</span> <span class="pre">4</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bpm</span> <span class="pre">=</span> <span class="pre">120</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">duration</span> <span class="pre">=</span> <span class="pre">4</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">octave</span> <span class="pre">=</span> <span class="pre">4</span></code></li>
</ul>
</div></blockquote>
</dd></dl>

<p>Built in Melodies</p>
<p>For the purposes of education and entertainment, the module contains several
example tunes that are expressed as Python lists. They can be used like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">music</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">music</span><span class="o">.</span><span class="n">NYAN</span><span class="p">)</span>
</pre></div>
</div>
<p>All the tunes are either out of copyright, composed by Nicholas H.Tollervey and
released to the public domain or have an unknown composer and are covered by a
fair (educational) use provision.</p>
<p>They are:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">DADADADUM</span></code> - the opening to Beethoven’s 5th Symphony in C minor.</li>
<li><code class="docutils literal notranslate"><span class="pre">ENTERTAINER</span></code> - the opening fragment of Scott Joplin’s Ragtime classic “The Entertainer”.</li>
<li><code class="docutils literal notranslate"><span class="pre">PRELUDE</span></code> - the opening of the first Prelude in C Major of J.S.Bach’s 48 Preludes and Fugues.</li>
<li><code class="docutils literal notranslate"><span class="pre">ODE</span></code> - the “Ode to Joy” theme from Beethoven’s 9th Symphony in D minor.</li>
<li><code class="docutils literal notranslate"><span class="pre">NYAN</span></code> - the Nyan Cat theme (<a class="reference external" href="http://www.nyan.cat/">http://www.nyan.cat/</a>). The composer is unknown. This is fair use for educational porpoises (as they say in New York).</li>
<li><code class="docutils literal notranslate"><span class="pre">RINGTONE</span></code> - something that sounds like a mobile phone ringtone. To be used to indicate an incoming message.</li>
<li><code class="docutils literal notranslate"><span class="pre">FUNK</span></code> - a funky bass line for secret agents and criminal masterminds.</li>
<li><code class="docutils literal notranslate"><span class="pre">BLUES</span></code> - a boogie-woogie 12-bar blues walking bass.</li>
<li><code class="docutils literal notranslate"><span class="pre">BIRTHDAY</span></code> - “Happy Birthday to You…” for copyright status see: <a class="reference external" href="http://www.bbc.co.uk/news/world-us-canada-34332853">http://www.bbc.co.uk/news/world-us-canada-34332853</a></li>
<li><code class="docutils literal notranslate"><span class="pre">WEDDING</span></code> - the bridal chorus from Wagner’s opera “Lohengrin”.</li>
<li><code class="docutils literal notranslate"><span class="pre">FUNERAL</span></code> - the “funeral march” otherwise known as Frédéric Chopin’s Piano Sonata No. 2 in B♭ minor, Op. 35.</li>
<li><code class="docutils literal notranslate"><span class="pre">PUNCHLINE</span></code> - a fun fragment that signifies a joke has been made.</li>
<li><code class="docutils literal notranslate"><span class="pre">PYTHON</span></code> - John Philip Sousa’s march “Liberty Bell” aka, the theme for “Monty Python’s Flying Circus” (after which the Python programming language is named).</li>
<li><code class="docutils literal notranslate"><span class="pre">BADDY</span></code> - silent movie era entrance of a baddy.</li>
<li><code class="docutils literal notranslate"><span class="pre">CHASE</span></code> - silent movie era chase scene.</li>
<li><code class="docutils literal notranslate"><span class="pre">BA_DING</span></code> - a short signal to indicate something has happened.</li>
<li><code class="docutils literal notranslate"><span class="pre">WAWAWAWAA</span></code> - a very sad trombone.</li>
<li><code class="docutils literal notranslate"><span class="pre">JUMP_UP</span></code> - for use in a game, indicating upward movement.</li>
<li><code class="docutils literal notranslate"><span class="pre">JUMP_DOWN</span></code> - for use in a game, indicating downward movement.</li>
<li><code class="docutils literal notranslate"><span class="pre">POWER_UP</span></code> - a fanfare to indicate an achievement unlocked.</li>
<li><code class="docutils literal notranslate"><span class="pre">POWER_DOWN</span></code> - a sad fanfare to indicate an achievement lost.</li>
</ul>
</div></blockquote>
<p>See the MicroPython forum for other community-supported alternatives
to transfer files to an nRF52832 board.</p>
</div>
<div class="section" id="module-ble">
<span id="ble"></span><h2>ble<a class="headerlink" href="#module-ble" title="Permalink to this headline">¶</a></h2>
<p>The ble module contains specific functions related to the nRF52832 bluetooth
hardware. Used incorrectly, this can lead to malfunction, lockups,
crashes of your board, and in extreme cases, hardware damage.</p>
<p>Functions</p>
<dl class="method">
<dt id="ble.ble.enable">
<code class="descclassname">ble.</code><code class="descname">enable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.ble.enable" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable BLE softdevice.</p>
</dd></dl>

<dl class="method">
<dt id="ble.ble.disable">
<code class="descclassname">ble.</code><code class="descname">disable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.ble.disable" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable BLE softdevice.</p>
</dd></dl>

<dl class="method">
<dt id="ble.ble.enabled">
<code class="descclassname">ble.</code><code class="descname">enabled</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.ble.enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Get state of whether the softdevice is enabled or not.</p>
</dd></dl>

<dl class="method">
<dt id="ble.ble.address">
<code class="descclassname">ble.</code><code class="descname">address</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.ble.address" title="Permalink to this definition">¶</a></dt>
<dd><p>Return device address as text string.</p>
</dd></dl>

</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="ble.mountsd.py">
<code class="descclassname">mountsd.</code><code class="descname">py</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.mountsd.py" title="Permalink to this definition">¶</a></dt>
<dd><p>Example for nrf52832 to show how mount and list a sdcard connected over SPI:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example for pca10040 / nrf52832 to show how mount and list a sdcard connected over SPI.</span>

<span class="sd">Direct wireing on SD card (SPI):</span>
<span class="sd"> ______________________________</span>
<span class="sd">|                              \</span>
<span class="sd">|             9.      | NC    | \</span>
<span class="sd">|             1.      | ~CS   | |</span>
<span class="sd">|             2.      | MOSI  | |</span>
<span class="sd">|             3.      | GND   | |</span>
<span class="sd">|             4.      | VCC3.3| |</span>
<span class="sd">|             5.      | SCK   | |</span>
<span class="sd">|             6.      | GND   | |</span>
<span class="sd">|             7.      | MISO  | |</span>
<span class="sd">|             8.      | NC    | |</span>
<span class="sd">|                               |</span>
<span class="sd">---------------------------------</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">SPI</span><span class="p">,</span> <span class="n">Pin</span>
<span class="kn">from</span> <span class="nn">sdcard</span> <span class="k">import</span> <span class="n">SDCard</span>

<span class="k">def</span> <span class="nf">mnt</span><span class="p">():</span>
    <span class="n">cs</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="s2">&quot;P11&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">SDCard</span><span class="p">(</span><span class="n">SPI</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">cs</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="n">sd</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">list</span><span class="p">():</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ble.musictest.py">
<code class="descclassname">musictest.</code><code class="descname">py</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.musictest.py" title="Permalink to this definition">¶</a></dt>
<dd><p>Example for nrf52832 to usage where “P3” is the Buzzer pin:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Example usage where &quot;P3&quot; is the Buzzer pin.</span>

<span class="sd">from musictest import play</span>
<span class="sd">play(&quot;P3&quot;)</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Pin</span>
<span class="kn">import</span> <span class="nn">music</span>

<span class="k">def</span> <span class="nf">play</span><span class="p">(</span><span class="n">pin_str</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="n">pin_str</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">)</span>
    <span class="n">music</span><span class="o">.</span><span class="n">play</span><span class="p">(</span><span class="n">music</span><span class="o">.</span><span class="n">PRELUDE</span><span class="p">,</span> <span class="n">pin</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ble.nrf52_pwm.py">
<code class="descclassname">nrf52_pwm.</code><code class="descname">py</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.nrf52_pwm.py" title="Permalink to this definition">¶</a></dt>
<dd><p>Example for nrf52832 to out pwm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">PWM</span><span class="p">,</span> <span class="n">Pin</span>

<span class="k">def</span> <span class="nf">pulse</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">PWM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Pin</span><span class="p">(</span><span class="s2">&quot;P17&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">FREQ_16MHZ</span><span class="p">,</span> <span class="n">duty</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">16000</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">101</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">PWM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Pin</span><span class="p">(</span><span class="s2">&quot;P17&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">),</span> <span class="n">freq</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">FREQ_16MHZ</span><span class="p">,</span> <span class="n">duty</span><span class="o">=</span><span class="mi">100</span><span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">16000</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ble.nrf52_servo.py">
<code class="descclassname">nrf52_servo.</code><code class="descname">py</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.nrf52_servo.py" title="Permalink to this definition">¶</a></dt>
<dd><p>Example for nrf52832 to driver servo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">PWM</span><span class="p">,</span> <span class="n">Pin</span>

<span class="k">class</span> <span class="nc">Servo</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pin_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pin_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pin</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="n">pin_name</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">,</span> <span class="n">pull</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">PULL_DOWN</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pin</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="s2">&quot;P17&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">OUT</span><span class="p">,</span> <span class="n">pull</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">PULL_DOWN</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">left</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">PWM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">FREQ_125KHZ</span><span class="p">,</span> <span class="n">pulse_width</span><span class="o">=</span><span class="mi">105</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">2500</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">MODE_HIGH_LOW</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">PWM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">FREQ_125KHZ</span><span class="p">,</span> <span class="n">pulse_width</span><span class="o">=</span><span class="mi">188</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">2500</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">MODE_HIGH_LOW</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">right</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">PWM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">FREQ_125KHZ</span><span class="p">,</span> <span class="n">pulse_width</span><span class="o">=</span><span class="mi">275</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">2500</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">MODE_HIGH_LOW</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ble.powerup.py">
<code class="descclassname">powerup.</code><code class="descname">py</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.powerup.py" title="Permalink to this definition">¶</a></dt>
<dd><p>Examples is written for nrf52832, pca10040 using s132 bluetooth stack:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># MicroPython controller for PowerUp 3.0 paper airplane</span>
<span class="c1"># https://www.poweruptoys.com/products/powerup-v3</span>
<span class="c1">#</span>
<span class="c1"># Examples is written for nrf52832, pca10040 using s132 bluetooth stack.</span>
<span class="c1">#</span>
<span class="c1"># Joystick shield pin mapping:</span>
<span class="c1">#  - analog stick x-direction - ADC0 - P0.02/&quot;P2&quot;</span>
<span class="c1">#  - buttons P0.13 - P0.16 / &quot;P13&quot;, &quot;P14&quot;, &quot;P15&quot;, &quot;P16&quot;</span>
<span class="c1">#</span>
<span class="c1"># Example usage:</span>
<span class="c1">#</span>
<span class="c1">#     from powerup import PowerUp3</span>
<span class="c1">#     p = PowerUp3()</span>

<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">ADC</span>
<span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">Pin</span>
<span class="kn">from</span> <span class="nn">ubluepy</span> <span class="k">import</span> <span class="n">Peripheral</span><span class="p">,</span> <span class="n">Scanner</span><span class="p">,</span> <span class="n">constants</span>

<span class="k">def</span> <span class="nf">bytes_to_str</span><span class="p">(</span><span class="nb">bytes</span><span class="p">):</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">string</span>

<span class="k">def</span> <span class="nf">get_device_names</span><span class="p">(</span><span class="n">scan_entries</span><span class="p">):</span>
    <span class="n">dev_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">scan_entries</span><span class="p">:</span>
        <span class="n">scan</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">getScanData</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">scan</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scan</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">ad_types</span><span class="o">.</span><span class="n">AD_TYPE_COMPLETE_LOCAL_NAME</span><span class="p">:</span>
                    <span class="n">dev_names</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">e</span><span class="p">,</span> <span class="n">bytes_to_str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
    <span class="k">return</span> <span class="n">dev_names</span>

<span class="k">def</span> <span class="nf">find_device_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">Scanner</span><span class="p">()</span>
    <span class="n">scan_res</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>

    <span class="n">device_names</span> <span class="o">=</span> <span class="n">get_device_names</span><span class="p">(</span><span class="n">scan_res</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dev</span> <span class="ow">in</span> <span class="n">device_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">dev</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">dev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">PowerUp3</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_adc</span> <span class="o">=</span> <span class="n">ADC</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_speed_up</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="s2">&quot;P13&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">pull</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">PULL_UP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_speed_down</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="s2">&quot;P15&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">pull</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">PULL_UP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_speed_full</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="s2">&quot;P14&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">pull</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">PULL_UP</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_speed_off</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="s2">&quot;P16&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">,</span> <span class="n">pull</span><span class="o">=</span><span class="n">Pin</span><span class="o">.</span><span class="n">PULL_UP</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">x_mid</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">calibrate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loop</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">read_stick_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_adc</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">button_speed_up</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_speed_up</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">button_speed_down</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_speed_down</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">button_speed_full</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_speed_full</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">button_speed_off</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_speed_off</span><span class="o">.</span><span class="n">value</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">calibrate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_mid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_stick_x</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;calibration x: </span><span class="si">%i</span><span class="s2">, y: </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_mid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">map_chars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">getServices</span><span class="p">()</span>

        <span class="n">service_batt</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">service_control</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">char_batt_lvl</span> <span class="o">=</span> <span class="n">service_batt</span><span class="o">.</span><span class="n">getCharacteristics</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char_control_speed</span> <span class="o">=</span> <span class="n">service_control</span><span class="o">.</span><span class="n">getCharacteristics</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">char_control_angle</span> <span class="o">=</span> <span class="n">service_control</span><span class="o">.</span><span class="n">getCharacteristics</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">battery_level</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">char_batt_lvl</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">speed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_speed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">new_speed</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">char_control_speed</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">char_control_speed</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">([</span><span class="n">new_speed</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">angle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_angle</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">new_angle</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">char_control_angle</span><span class="o">.</span><span class="n">read</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">char_control_angle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">([</span><span class="n">new_angle</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dev</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># connect to the airplane</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">dev</span><span class="p">:</span>
            <span class="n">dev</span> <span class="o">=</span> <span class="n">find_device_by_name</span><span class="p">(</span><span class="s2">&quot;TailorToys PowerUp&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dev</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">p</span> <span class="o">=</span> <span class="n">Peripheral</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dev</span><span class="o">.</span><span class="n">addr</span><span class="p">())</span>

        <span class="c1"># locate interesting characteristics</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_chars</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">rudder_center</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_angle</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">old_angle</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">rudder_left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">(</span><span class="n">angle</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval_size_left</span><span class="p">)</span>
        <span class="n">new_angle</span> <span class="o">=</span> <span class="mi">60</span> <span class="o">-</span> <span class="n">steps</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_angle</span> <span class="o">!=</span> <span class="n">new_angle</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">new_angle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">old_angle</span> <span class="o">=</span> <span class="n">new_angle</span>

    <span class="k">def</span> <span class="nf">rudder_right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">(</span><span class="n">angle</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval_size_right</span><span class="p">)</span>
        <span class="n">new_angle</span> <span class="o">=</span> <span class="o">-</span><span class="n">steps</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_angle</span> <span class="o">!=</span> <span class="n">new_angle</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">new_angle</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">old_angle</span> <span class="o">=</span> <span class="n">new_angle</span>

    <span class="k">def</span> <span class="nf">throttle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speed</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">speed</span> <span class="o">&gt;</span> <span class="mi">200</span><span class="p">):</span>
            <span class="n">speed</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">speed</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">speed</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_speed</span> <span class="o">!=</span> <span class="n">speed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">speed</span><span class="p">(</span><span class="n">speed</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">old_speed</span> <span class="o">=</span> <span class="n">speed</span>

    <span class="k">def</span> <span class="nf">loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">adc_threshold</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">right_threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_mid</span> <span class="o">+</span> <span class="n">adc_threshold</span>
        <span class="n">left_threshold</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_mid</span> <span class="o">-</span> <span class="n">adc_threshold</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interval_size_left</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_mid</span> <span class="o">//</span> <span class="mi">60</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interval_size_right</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_mid</span><span class="p">)</span> <span class="o">//</span> <span class="mi">60</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">old_angle</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">old_speed</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

            <span class="c1"># read out new angle</span>
            <span class="n">new_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_stick_x</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">new_angle</span> <span class="o">&lt;</span> <span class="mi">256</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">new_angle</span> <span class="o">&gt;</span> <span class="n">right_threshold</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rudder_right</span><span class="p">(</span><span class="n">new_angle</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_mid</span><span class="p">)</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">new_angle</span> <span class="o">&lt;</span> <span class="n">left_threshold</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rudder_left</span><span class="p">(</span><span class="n">new_angle</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">rudder_center</span><span class="p">()</span>

            <span class="c1"># read out new speed</span>
                <span class="n">new_speed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">old_speed</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_speed_up</span><span class="p">():</span>
                <span class="n">new_speed</span> <span class="o">+=</span> <span class="mi">25</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_speed_down</span><span class="p">():</span>
                <span class="n">new_speed</span> <span class="o">-=</span> <span class="mi">25</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_speed_full</span><span class="p">():</span>
                <span class="n">new_speed</span> <span class="o">=</span> <span class="mi">200</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">button_speed_off</span><span class="p">():</span>
                <span class="n">new_speed</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">throttle</span><span class="p">(</span><span class="n">new_speed</span><span class="p">)</span>

            <span class="n">p</span> <span class="o">=</span> <span class="n">PWM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pin</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">FREQ_125KHZ</span><span class="p">,</span> <span class="n">pulse_width</span><span class="o">=</span><span class="mi">275</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">2500</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">PWM</span><span class="o">.</span><span class="n">MODE_HIGH_LOW</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep_ms</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">deinit</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ble.ssd1306_oled.py">
<code class="descclassname">ssd1306_oled.</code><code class="descname">py</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.ssd1306_oled.py" title="Permalink to this definition">¶</a></dt>
<dd><p>Examples is written for nrf52832 driver ssd1306 oled displayer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># NOTE: Modified version to align with implemented I2C API in nrf port.</span>
<span class="c1">#</span>
<span class="c1"># Examples usage of SSD1306_SPI on pca10040</span>
<span class="c1">#</span>
<span class="c1"># from machine import Pin, SPI</span>
<span class="c1"># from ssd1306 import SSD1306_SPI</span>
<span class="c1"># spi = SPI(0, baudrate=40000000)</span>
<span class="c1"># dc = Pin.board.PA11</span>
<span class="c1"># res = Pin.board.PA12</span>
<span class="c1"># cs = Pin.board.PA13</span>
<span class="c1"># disp = SSD1306_SPI(128, 64, spi, dc, res, cs)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># Example usage of SSD1306_I2C on pca10040</span>
<span class="c1">#</span>
<span class="c1"># from machine import Pin, I2C</span>
<span class="c1"># from ssd1306_mod import SSD1306_I2C_Mod</span>
<span class="c1"># i2c = I2C(0, Pin(26), Pin(25))</span>
<span class="c1"># disp = SSD1306_I2C_Mod(128, 64, i2c)</span>

<span class="kn">from</span> <span class="nn">ssd1306</span> <span class="k">import</span> <span class="n">SSD1306_I2C</span>

<span class="n">SET_COL_ADDR</span>        <span class="o">=</span> <span class="n">const</span><span class="p">(</span><span class="mh">0x21</span><span class="p">)</span>
<span class="n">SET_PAGE_ADDR</span>       <span class="o">=</span> <span class="n">const</span><span class="p">(</span><span class="mh">0x22</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">SSD1306_I2C_Mod</span><span class="p">(</span><span class="n">SSD1306_I2C</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">x1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">width</span> <span class="o">==</span> <span class="mi">64</span><span class="p">:</span>
            <span class="c1"># displays with width of 64 pixels are shifted by 32</span>
            <span class="n">x0</span> <span class="o">+=</span> <span class="mi">32</span>
            <span class="n">x1</span> <span class="o">+=</span> <span class="mi">32</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_cmd</span><span class="p">(</span><span class="n">SET_COL_ADDR</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_cmd</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_cmd</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_cmd</span><span class="p">(</span><span class="n">SET_PAGE_ADDR</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_cmd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_cmd</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pages</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">chunk_size</span> <span class="o">=</span> <span class="mi">254</span> <span class="c1"># 255, excluding opcode.</span>
        <span class="n">num_of_chunks</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span> <span class="o">//</span> <span class="n">chunk_size</span>
        <span class="n">leftover</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">num_of_chunks</span> <span class="o">*</span> <span class="n">chunk_size</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_of_chunks</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">chunk_size</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="n">chunk_size</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">leftover</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">chunk_size</span> <span class="o">*</span> <span class="n">num_of_chunks</span><span class="p">:])</span>


    <span class="k">def</span> <span class="nf">write_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buf</span><span class="p">):</span>
        <span class="n">buffer</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span><span class="mh">0x40</span><span class="p">])</span> <span class="o">+</span> <span class="n">buf</span> <span class="c1"># Co=0, D/C#=1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">i2c</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addr</span><span class="p">,</span> <span class="n">buffer</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="ble.ubluepy_eddystone.py">
<code class="descclassname">ubluepy_eddystone.</code><code class="descname">py</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ble.ubluepy_eddystone.py" title="Permalink to this definition">¶</a></dt>
<dd><p>Examples is written for nrf52832 ubluepy module API example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ubluepy</span> <span class="k">import</span> <span class="n">Peripheral</span><span class="p">,</span> <span class="n">constants</span>

<span class="n">BLE_GAP_ADV_FLAG_LE_GENERAL_DISC_MODE</span>       <span class="o">=</span> <span class="n">const</span><span class="p">(</span><span class="mh">0x02</span><span class="p">)</span>
<span class="n">BLE_GAP_ADV_FLAG_BR_EDR_NOT_SUPPORTED</span>       <span class="o">=</span> <span class="n">const</span><span class="p">(</span><span class="mh">0x04</span><span class="p">)</span>

<span class="n">BLE_GAP_ADV_FLAGS_LE_ONLY_GENERAL_DISC_MODE</span> <span class="o">=</span> <span class="n">const</span><span class="p">(</span><span class="n">BLE_GAP_ADV_FLAG_LE_GENERAL_DISC_MODE</span> <span class="o">|</span> <span class="n">BLE_GAP_ADV_FLAG_BR_EDR_NOT_SUPPORTED</span><span class="p">)</span>

<span class="n">EDDYSTONE_FRAME_TYPE_URL</span>                    <span class="o">=</span> <span class="n">const</span><span class="p">(</span><span class="mh">0x10</span><span class="p">)</span>
<span class="n">EDDYSTONE_URL_PREFIX_HTTP_WWW</span>               <span class="o">=</span> <span class="n">const</span><span class="p">(</span><span class="mh">0x00</span><span class="p">)</span> <span class="c1"># &quot;http://www&quot;.</span>
<span class="n">EDDYSTONE_URL_SUFFIX_DOT_COM</span>                <span class="o">=</span> <span class="n">const</span><span class="p">(</span><span class="mh">0x01</span><span class="p">)</span> <span class="c1"># &quot;.com&quot;</span>

<span class="k">def</span> <span class="nf">string_to_binarray</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">text</span><span class="p">:</span>
        <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">gen_ad_type_content</span><span class="p">(</span><span class="n">ad_type</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ad_type</span><span class="p">)</span>
    <span class="n">b</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">generate_eddystone_adv_packet</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="c1"># flags</span>
    <span class="n">disc_mode</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span><span class="n">BLE_GAP_ADV_FLAGS_LE_ONLY_GENERAL_DISC_MODE</span><span class="p">])</span>
    <span class="n">packet_flags</span> <span class="o">=</span> <span class="n">gen_ad_type_content</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">ad_types</span><span class="o">.</span><span class="n">AD_TYPE_FLAGS</span><span class="p">,</span> <span class="n">disc_mode</span><span class="p">)</span>

    <span class="c1"># 16-bit uuid</span>
    <span class="n">uuid</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([</span><span class="mh">0xAA</span><span class="p">,</span> <span class="mh">0xFE</span><span class="p">])</span>
    <span class="n">packet_uuid16</span> <span class="o">=</span> <span class="n">gen_ad_type_content</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">ad_types</span><span class="o">.</span><span class="n">AD_TYPE_16BIT_SERVICE_UUID_COMPLETE</span><span class="p">,</span> <span class="n">uuid</span><span class="p">)</span>

    <span class="c1"># eddystone data</span>
    <span class="n">rssi</span> <span class="o">=</span> <span class="mh">0xEE</span> <span class="c1"># -18 dB, approx signal strength at 0m.</span>
    <span class="n">eddystone_data</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([])</span>
    <span class="n">eddystone_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EDDYSTONE_FRAME_TYPE_URL</span><span class="p">)</span>
    <span class="n">eddystone_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rssi</span><span class="p">)</span>
    <span class="n">eddystone_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EDDYSTONE_URL_PREFIX_HTTP_WWW</span><span class="p">)</span>
    <span class="n">eddystone_data</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">string_to_binarray</span><span class="p">(</span><span class="n">url</span><span class="p">))</span>
    <span class="n">eddystone_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EDDYSTONE_URL_SUFFIX_DOT_COM</span><span class="p">)</span>

    <span class="c1"># service data</span>
    <span class="n">service_data</span> <span class="o">=</span> <span class="n">uuid</span> <span class="o">+</span> <span class="n">eddystone_data</span>
    <span class="n">packet_service_data</span> <span class="o">=</span> <span class="n">gen_ad_type_content</span><span class="p">(</span><span class="n">constants</span><span class="o">.</span><span class="n">ad_types</span><span class="o">.</span><span class="n">AD_TYPE_SERVICE_DATA</span><span class="p">,</span> <span class="n">service_data</span><span class="p">)</span>

    <span class="c1"># generate advertisment packet</span>
    <span class="n">packet</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">([])</span>
    <span class="n">packet</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">packet_flags</span><span class="p">)</span>
    <span class="n">packet</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">packet_uuid16</span><span class="p">)</span>
    <span class="n">packet</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">packet_service_data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">packet</span>

<span class="k">def</span> <span class="nf">start</span><span class="p">():</span>
    <span class="n">adv_packet</span> <span class="o">=</span> <span class="n">generate_eddystone_adv_packet</span><span class="p">(</span><span class="s2">&quot;micropython&quot;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Peripheral</span><span class="p">()</span>
    <span class="n">p</span><span class="o">.</span><span class="n">advertise</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">adv_packet</span><span class="p">,</span> <span class="n">connectable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="descclassname">ubluepy_eddystone.</code><code class="descname">py</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Examples is written for nrf52832 ubluepy module scan example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ubluepy</span> <span class="k">import</span> <span class="n">Scanner</span><span class="p">,</span> <span class="n">constants</span>

<span class="k">def</span> <span class="nf">bytes_to_str</span><span class="p">(</span><span class="nb">bytes</span><span class="p">):</span>
    <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">bytes</span><span class="p">:</span>
        <span class="n">string</span> <span class="o">+=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">string</span>

<span class="k">def</span> <span class="nf">get_device_names</span><span class="p">(</span><span class="n">scan_entries</span><span class="p">):</span>
    <span class="n">dev_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">scan_entries</span><span class="p">:</span>
        <span class="n">scan</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">getScanData</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">scan</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scan</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">ad_types</span><span class="o">.</span><span class="n">AD_TYPE_COMPLETE_LOCAL_NAME</span><span class="p">:</span>
                    <span class="n">dev_names</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">e</span><span class="p">,</span> <span class="n">bytes_to_str</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
    <span class="k">return</span> <span class="n">dev_names</span>

<span class="k">def</span> <span class="nf">find_device_by_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">Scanner</span><span class="p">()</span>
    <span class="n">scan_res</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

    <span class="n">device_names</span> <span class="o">=</span> <span class="n">get_device_names</span><span class="p">(</span><span class="n">scan_res</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">dev</span> <span class="ow">in</span> <span class="n">device_names</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="n">dev</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">dev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># &gt;&gt;&gt; res = find_device_by_name(&quot;micr&quot;)</span>
<span class="c1"># &gt;&gt;&gt; if res:</span>
<span class="c1"># ...     print(&quot;address:&quot;, res.addr())</span>
<span class="c1"># ...     print(&quot;address type:&quot;, res.addr_type())</span>
<span class="c1"># ...     print(&quot;rssi:&quot;, res.rssi())</span>
<span class="c1"># ...</span>
<span class="c1"># ...</span>
<span class="c1"># ...</span>
<span class="c1"># address: c2:73:61:89:24:45</span>
<span class="c1"># address type: 1</span>
<span class="c1"># rssi: -26</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt>
<code class="descclassname">ubluepy_eddystone.</code><code class="descname">py</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Examples is written for nrf52832 ubluepy module temp example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">board</span> <span class="k">import</span> <span class="n">LED</span>
<span class="kn">from</span> <span class="nn">machine</span> <span class="k">import</span> <span class="n">RTCounter</span><span class="p">,</span> <span class="n">Temp</span>
<span class="kn">from</span> <span class="nn">ubluepy</span> <span class="k">import</span> <span class="n">Service</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">,</span> <span class="n">UUID</span><span class="p">,</span> <span class="n">Peripheral</span><span class="p">,</span> <span class="n">constants</span>

<span class="k">def</span> <span class="nf">event_handler</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">handle</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">rtc</span>
    <span class="k">global</span> <span class="n">periph</span>
    <span class="k">global</span> <span class="n">serv_env_sense</span>
    <span class="k">global</span> <span class="n">notif_enabled</span>

    <span class="k">if</span> <span class="nb">id</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">EVT_GAP_CONNECTED</span><span class="p">:</span>
        <span class="c1"># indicated &#39;connected&#39;</span>
        <span class="n">LED</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">()</span>

    <span class="k">elif</span> <span class="nb">id</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">EVT_GAP_DISCONNECTED</span><span class="p">:</span>
        <span class="c1"># stop low power timer</span>
        <span class="n">rtc</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="c1"># indicate &#39;disconnected&#39;</span>
        <span class="n">LED</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>
        <span class="c1"># restart advertisment</span>
        <span class="n">periph</span><span class="o">.</span><span class="n">advertise</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;micr_temp&quot;</span><span class="p">,</span> <span class="n">services</span><span class="o">=</span><span class="p">[</span><span class="n">serv_env_sense</span><span class="p">])</span>

    <span class="k">elif</span> <span class="nb">id</span> <span class="o">==</span> <span class="n">constants</span><span class="o">.</span><span class="n">EVT_GATTS_WRITE</span><span class="p">:</span>
        <span class="c1"># write to this Characteristic is to CCCD</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">notif_enabled</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># start low power timer</span>
            <span class="n">rtc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">notif_enabled</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="c1"># stop low power timer</span>
            <span class="n">rtc</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">send_temp</span><span class="p">(</span><span class="n">timer_id</span><span class="p">):</span>
    <span class="k">global</span> <span class="n">notif_enabled</span>
    <span class="k">global</span> <span class="n">char_temp</span>

    <span class="k">if</span> <span class="n">notif_enabled</span><span class="p">:</span>
        <span class="c1"># measure chip temperature</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">Temp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">temp</span> <span class="o">=</span>  <span class="n">temp</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="n">char_temp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">bytearray</span><span class="p">([</span><span class="n">temp</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="n">temp</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">]))</span>

<span class="c1"># start off with LED(1) off</span>
<span class="n">LED</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">off</span><span class="p">()</span>

<span class="c1"># use RTC1 as RTC0 is used by bluetooth stack</span>
<span class="c1"># set up RTC callback every 5 second</span>
<span class="n">rtc</span> <span class="o">=</span> <span class="n">RTCounter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">RTCounter</span><span class="o">.</span><span class="n">PERIODIC</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">send_temp</span><span class="p">)</span>

<span class="n">notif_enabled</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">uuid_env_sense</span> <span class="o">=</span> <span class="n">UUID</span><span class="p">(</span><span class="s2">&quot;0x181A&quot;</span><span class="p">)</span> <span class="c1"># Environmental Sensing service</span>
<span class="n">uuid_temp</span> <span class="o">=</span> <span class="n">UUID</span><span class="p">(</span><span class="s2">&quot;0x2A6E&quot;</span><span class="p">)</span> <span class="c1"># Temperature characteristic</span>

<span class="n">serv_env_sense</span> <span class="o">=</span> <span class="n">Service</span><span class="p">(</span><span class="n">uuid_env_sense</span><span class="p">)</span>

<span class="n">temp_props</span> <span class="o">=</span> <span class="n">Characteristic</span><span class="o">.</span><span class="n">PROP_NOTIFY</span> <span class="o">|</span> <span class="n">Characteristic</span><span class="o">.</span><span class="n">PROP_READ</span>
<span class="n">temp_attrs</span> <span class="o">=</span> <span class="n">Characteristic</span><span class="o">.</span><span class="n">ATTR_CCCD</span>
<span class="n">char_temp</span> <span class="o">=</span> <span class="n">Characteristic</span><span class="p">(</span><span class="n">uuid_temp</span><span class="p">,</span> <span class="n">props</span> <span class="o">=</span> <span class="n">temp_props</span><span class="p">,</span> <span class="n">attrs</span> <span class="o">=</span> <span class="n">temp_attrs</span><span class="p">)</span>

<span class="n">serv_env_sense</span><span class="o">.</span><span class="n">addCharacteristic</span><span class="p">(</span><span class="n">char_temp</span><span class="p">)</span>

<span class="n">periph</span> <span class="o">=</span> <span class="n">Peripheral</span><span class="p">()</span>
<span class="n">periph</span><span class="o">.</span><span class="n">addService</span><span class="p">(</span><span class="n">serv_env_sense</span><span class="p">)</span>
<span class="n">periph</span><span class="o">.</span><span class="n">setConnectionHandler</span><span class="p">(</span><span class="n">event_handler</span><span class="p">)</span>
<span class="n">periph</span><span class="o">.</span><span class="n">advertise</span><span class="p">(</span><span class="n">device_name</span><span class="o">=</span><span class="s2">&quot;micr_temp&quot;</span><span class="p">,</span> <span class="n">services</span><span class="o">=</span><span class="p">[</span><span class="n">serv_env_sense</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="general.html" class="btn btn-neutral float-right" title="General information about the nRF52832 port" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../wipy/tutorial/reset.html" class="btn btn-neutral" title="6. Reset and boot modes" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2019, Damien P. George, Paul Sokolovsky, and contributors
      Last updated on 30 May 2019.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Versions and Downloads</span>
    latest
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Versions</dt>
      
        <dd><a href="//en/latest">latest</a></dd>
      
    </dl>
    <dl>
      <dt>Downloads</dt>
      
        <dd><a href="//en/latest/micropython-docs.pdf">PDF</a></dd>
      
    </dl>
    <hr/>
    <dl>
      <dt>External links</dt>
        <dd>
          <a href="https://www.micropython.org">micropython.org</a>
        </dd>
        <dd>
          <a href="https://github.com/micropython/micropython">GitHub</a>
        </dd>
    </dl>
  </div>
</div>

  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'1.10',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../static/jquery.js"></script>
        <script type="text/javascript" src="../static/underscore.js"></script>
        <script type="text/javascript" src="../static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>